<!DOCTYPE html><html
lang="en-US"><head><meta
charset="UTF-8"><meta
name="viewport" content="width=device-width"><title>Merge and Join DataFrames with Pandas in Python | Shane Lynn</title><link
rel="profile" href="http://gmpg.org/xfn/11"><link
rel="shortcut icon" href=""/><link
rel="pingback" href="https://www.shanelynn.ie/xmlrpc.php">
<!--[if lt IE 9]> <script src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/html5.js"></script> <![endif]--><meta
name="description"  content="Join and Merge datasets and DataFrames in Pandas quickly and easily with the merge() function. Master left, right, inner, and outer merging with this tutorial. Merging and Joining data sets are key activities of any data scientist or analyst." /><meta
name="keywords"  content="data,data science,data wrangling,dataframe,datascience,join,joining,merge,merging,pandas,processing,python,sql" /><link
rel="canonical" href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/" /><link
rel='dns-prefetch' href='//platform.twitter.com' /><link
rel='dns-prefetch' href='//s0.wp.com' /><link
rel='dns-prefetch' href='//ajax.googleapis.com' /><link
rel='dns-prefetch' href='//fonts.googleapis.com' /><link
rel='dns-prefetch' href='//s.w.org' /><link
rel="alternate" type="application/rss+xml" title="Shane Lynn &raquo; Feed" href="https://www.shanelynn.ie/feed/" /><link
rel="alternate" type="application/rss+xml" title="Shane Lynn &raquo; Comments Feed" href="https://www.shanelynn.ie/comments/feed/" /><link
rel="alternate" type="application/rss+xml" title="Shane Lynn &raquo; Merge and Join DataFrames with Pandas in Python Comments Feed" href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/feed/" /> <script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.shanelynn.ie\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.5"}};!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script> <script>/*<![CDATA[*/advanced_ads_ready=function(){var fns=[],listener,doc=typeof document==="object"&&document,hack=doc&&doc.documentElement.doScroll,domContentLoaded="DOMContentLoaded",loaded=doc&&(hack?/^loaded|^c/:/^loaded|^i|^c/).test(doc.readyState);if(!loaded&&doc){listener=function(){doc.removeEventListener(domContentLoaded,listener);window.removeEventListener("load",listener);loaded=1;while(listener=fns.shift())listener()};doc.addEventListener(domContentLoaded,listener);window.addEventListener("load",listener)}return function(fn){loaded?setTimeout(fn,0):fns.push(fn)}}();/*]]>*/</script><style type="text/css">img.wp-smiley,img.emoji{display:inline !important;border:none !important;box-shadow:none !important;height:1em !important;width:1em !important;margin:0
.07em !important;vertical-align:-0.1em !important;background:none !important;padding:0
!important}</style><link
rel='stylesheet' id='crayon-theme-classic-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' /><link
rel='stylesheet' id='crayon-font-monaco-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' /><link
rel='stylesheet' id='contact-form-7-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.1' type='text/css' media='all' /><link
rel='stylesheet' id='ctf_styles-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/custom-twitter-feeds/css/ctf-styles.css?ver=1.2.8' type='text/css' media='all' /><link
rel='stylesheet' id='google-raleway-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C700italic%2C800italic%2C400%2C300%2C600%2C700%2C800&#038;ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-bootstrap-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/resources/bootstrap/css/bootstrap.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-swipebox-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/swipebox.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-owl-carousel-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/owl.carousel.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-owl-theme-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/owl.theme.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-animations-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/animations.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-meanmenu-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/meanmenu.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='ascent-main-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/css/main.css?ver=4.9.5' type='text/css' media='all' /><link
rel='stylesheet' id='jetpack-widget-social-icons-styles-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/modules/widgets/social-icons/social-icons.css?ver=20170506' type='text/css' media='all' /><link
rel='stylesheet' id='easy_table_style-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/easy-table/themes/default/style.css?ver=1.6' type='text/css' media='all' /><link
rel='stylesheet' id='enlighter-local-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.css?ver=3.5' type='text/css' media='all' /><link
rel='stylesheet' id='an_style-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/ywrMnyIoxdTt/eHjUtdkTrPUU.css?ver=2.2.3' type='text/css' media='all' /><style id='an_style-inline-css' type='text/css'>.AnEaCyNbUfNi-bg{display:none;position:fixed;z-index:100;top:0;left:0;width:100%;height:100%;background:#000;background:rgba(0,0,0,0.75)}.AnEaCyNbUfNi{visibility:hidden;position:fixed;z-index:101;top:100px;right:0;left:0;max-width:640px;margin-right:auto;margin-left:auto;background:#fff;-webkit-box-shadow:0 3px 5px 2px rgba(0,0,0,0.25);box-shadow:0 3px 5px 2px rgba(0,0,0,0.25);font-family:Arial,Helvetica,sans-serif}.AnEaCyNbUfNi-default,.AnEaCyNbUfNi-ok{padding:30px
30px 15px}.AnEaCyNbUfNi-image{overflow:hidden;position:relative;width:100%}.AnEaCyNbUfNi-image .AnEaCyNbUfNi-left{position:absolute;top:0;left:0;width:50%;height:100%}.AnEaCyNbUfNi-image .AnEaCyNbUfNi-right{float:right;width:50%;padding:30px}.AnEaCyNbUfNi.small{width:200px;margin-left:-140px}.AnEaCyNbUfNi.medium{width:400px;margin-left:-240px}.AnEaCyNbUfNi.large{width:600px;margin-left:-340px}.AnEaCyNbUfNi.xlarge{width:800px;margin-left:-440px}.close-AnEaCyNbUfNi{display:inline-block;position:absolute;top:15px;right:15px;width:30px;height:30px;color:#bbb;font-size:32px;font-weight:700;line-height:30px;text-align:center;cursor:pointer;-webkit-transition:0.3s;transition:0.3s}.close-AnEaCyNbUfNi:hover{color:#252b37}.AnEaCyNbUfNi
h1{margin-bottom:15px;padding:0
30px;color:#252b37;font-size:28px;line-height:1.25;text-align:center}.AnEaCyNbUfNi-right
h1{padding:0
30px 0 0;text-align:left}.AnEaCyNbUfNi
p{margin-bottom:15px;color:#333745;font-size:14px}.AnEaCyNbUfNi p
a{color:#ff6160}.AnEaCyNbUfNi-right .close-modal,.AnEaCyNbUfNi-footer .close-modal{padding:15px
!important;border-radius:0 !important;background-color:#ff6160;font-size:14px;letter-spacing:2px !important;-webkit-transition:0.3s;transition:0.3s}.AnEaCyNbUfNi-right .close-modal:hover,.AnEaCyNbUfNi-footer .close-modal:hover{background-color:#252b37 !important}.AnEaCyNbUfNi-footer .grey-button-modal{margin-right:15px;background-color:#a5a5a5}.AnEaCyNbUfNi-footer{display:block;padding:15px
30px;background-color:#eff4f7;text-align:right}@media only screen and (max-width: 640px){.AnEaCyNbUfNi{right:5%;left:5%;max-width:90%}.AnEaCyNbUfNi-default{padding:20px}.AnEaCyNbUfNi-image .AnEaCyNbUfNi-left{width:100%;height:250px}.AnEaCyNbUfNi-image .AnEaCyNbUfNi-right{float:left;width:100%;margin-top:250px;padding:20px}.AnEaCyNbUfNi
h1{margin-bottom:10px;font-size:20px}.AnEaCyNbUfNi-right
h1{padding:0}.AnEaCyNbUfNi
p{margin-bottom:10px}.close-AnEaCyNbUfNi{color:#fcfcfc;background-color:#252b37}.close-AnEaCyNbUfNi:hover{color:#252b37;background-color:#fcfcfc}.AnEaCyNbUfNi-footer{padding:15px
20px}}@media only screen and (max-width: 480px){.AnEaCyNbUfNi-image .AnEaCyNbUfNi-left{height:200px}.AnEaCyNbUfNi-image .AnEaCyNbUfNi-right{margin-top:200px}.AnEaCyNbUfNi-footer{text-align:center}.AnEaCyNbUfNi-footer .close-modal{width:80%;margin:5px
10%}}</style><link
rel='stylesheet' id='jetpack_css-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/css/jetpack.css?ver=6.0' type='text/css' media='all' /> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script> <script type='text/javascript'>var related_posts_js_options={"post_heading":"h4"};</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js?ver=20150408'></script> <script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/resources/bootstrap/js/bootstrap.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/bootstrap-wp.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/jquery.swipebox.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/swipebox-config.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/owl.carousel.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/jquery.appear.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/jquery.meanmenu.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/jquery.velocity.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/appear.config.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/main.js?ver=4.9.5'></script> <link
rel='https://api.w.org/' href='https://www.shanelynn.ie/wp-json/' /><link
rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-includes/wlwmanifest.xml" /><link
rel='prev' title='Batch CSV Geocoding in Python with Google Maps API' href='https://www.shanelynn.ie/batch-geocoding-in-python-with-google-geocoding-api/' /><link
rel='next' title='Using big data to create better mobile video games' href='https://www.shanelynn.ie/using-big-data-to-create-better-mobile-video-games/' /><meta
name="generator" content="WordPress 4.9.5" /><link
rel='shortlink' href='https://www.shanelynn.ie/?p=702' /><link
rel="alternate" type="application/json+oembed" href="https://www.shanelynn.ie/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F" /><link
rel="alternate" type="text/xml+oembed" href="https://www.shanelynn.ie/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F&#038;format=xml" /><link
rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.shanelynn.ie/xmlrpc2.php?rsd" /><link
rel='dns-prefetch' href='//jetpack.wordpress.com'/><link
rel='dns-prefetch' href='//s0.wp.com'/><link
rel='dns-prefetch' href='//s1.wp.com'/><link
rel='dns-prefetch' href='//s2.wp.com'/><link
rel='dns-prefetch' href='//public-api.wordpress.com'/><link
rel='dns-prefetch' href='//0.gravatar.com'/><link
rel='dns-prefetch' href='//1.gravatar.com'/><link
rel='dns-prefetch' href='//2.gravatar.com'/><style type='text/css'>img#wpstats{display:none}</style><style type='text/css' id='dynamic-css'></style><style type="text/css"></style><link
rel="amphtml" href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/amp/"><meta
property="og:type" content="article" /><meta
property="og:title" content="Merge and Join DataFrames with Pandas in Python" /><meta
property="og:url" content="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/" /><meta
property="og:description" content="Merging and Joining data sets are key activities of any data scientist or analyst. In this tutorial, we explore the process of combining datasets based on common columns quickly and easily with the…" /><meta
property="article:published_time" content="2017-03-05T15:14:55+00:00" /><meta
property="article:modified_time" content="2017-03-28T16:49:08+00:00" /><meta
property="og:site_name" content="Shane Lynn" /><meta
property="og:image" content="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background.jpg" /><meta
property="og:image:width" content="950" /><meta
property="og:image:height" content="212" /><meta
property="og:locale" content="en_US" /><meta
name="twitter:text:title" content="Merge and Join DataFrames with Pandas in Python" /><meta
name="twitter:card" content="summary" /> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-2568178699868194",enable_page_level_ads:true});</script> <style type="text/css" id="wp-custom-css">.entry-content{font-size:1.2em;line-height:150%;text-align:justify}.wp-caption-text{font-size:1em}h2{margin-top:0.8em;margin-bottom:0.4em}.shane-content{margin-top:30px;margin-bottom:30px}.shane-content-1{margin-top:30px;margin-bottom:30px}#googleadwords{width:263px;height:600px}</style></head><body
class="post-template-default single single-post postid-702 single-format-standard"><header
id="masthead" class="site-header" role="banner"><div
class="header-top"><div
class="container"><div
class="row"><div
class="col-sm-6"><div
class="mail-info"></div></div><div
class="col-sm-6"><div
class="header-social-icon-wrap"><ul
class="social-icons"><li
class="social-icon"><a
target="_blank" href="http://twitter.com/shane_a_lynn"><i
class="fa fa-twitter"></i></a></li><li
class="social-icon"><a
target="_blank" href="http://facebook.com/shanerlynn"><i
class="fa fa-facebook"></i></a></li><li
class="social-icon"><a
target="_blank" href="https://www.linkedin.com/in/shanealynn"><i
class="fa fa-linkedin"></i></a></li><li
class="social-icon"><a
target="_blank" href="http://www.github.com/shanealynn"><i
class="fa fa-github"></i></a></li></ul></div></div></div></div></div><div
id="header-main" class="header-bottom"><div
class="header-bottom-inner"><div
class="container"><div
class="row"><div
class="col-sm-3"><div
id="logo"><div
class="site-header-inner col-sm-12"><div
class="site-branding"><h1 class="site-title">
<a
href="https://www.shanelynn.ie/" title="Shane Lynn" rel="home">
Shane Lynn                        				                        				    </a></h1><h4 class="site-description">Data science, Startups, Analytics and Data visualisation.</h4></div></div></div></div><div
class="col-sm-9"><div
class="header-search pull-right"><div
id="header-search-button"><i
class="fa fa-search"></i></div></div><div
class="site-navigation pull-right">
<nav
class="main-menu"><ul
id="menu-home" class="header-nav clearfix"><li
id="menu-item-56" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-56"><a
href="https://www.shanelynn.ie">Blog</a></li><li
id="menu-item-53" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"><a
href="https://www.shanelynn.ie/about/">About</a></li><li
id="menu-item-800" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-800"><a
href="https://www.shanelynn.ie/category/tutorials/">Pandas Tutorials</a><ul
class="sub-menu"><li
id="menu-item-954" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-954"><a
href="https://www.shanelynn.ie/using-pandas-dataframe-creating-editing-viewing-data-in-python/">The Pandas DataFrame – creating, editing, and viewing data in Python</a></li><li
id="menu-item-799" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-799"><a
href="https://www.shanelynn.ie/summarising-aggregation-and-grouping-data-in-python-pandas/">Summarising, Aggregating, and Grouping data</a></li><li
id="menu-item-798" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-798"><a
href="https://www.shanelynn.ie/select-pandas-dataframe-rows-and-columns-using-iloc-loc-and-ix/">Use iloc, loc, &#038; ix for DataFrame selections</a></li><li
id="menu-item-797" class="menu-item menu-item-type-post_type menu-item-object-post current-menu-item menu-item-797"><a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/">Master Merges and Joins with Pandas</a></li></ul></li><li
id="menu-item-694" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-694"><a
href="https://www.shanelynn.ie/consultancy-services/">Consultancy &#038; Services</a></li><li
id="menu-item-55" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-55"><a
href="https://www.shanelynn.ie/research/">Research</a></li><li
id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a
href="https://www.shanelynn.ie/publications/">Publications</a></li><li
id="menu-item-54" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-54"><a
href="https://www.shanelynn.ie/contact/">Contact</a></li></ul>            			    </nav><div
id="responsive-menu-container"></div></div></div></div></div></div></div><div
id="header-search-form-wrap" class="header-search-form-wrap"><div
class="container"><form
role="search" method="get" class="header-search-form search-form" action="https://www.shanelynn.ie/"><div
class="control-group">
<i
class="fa fa-search"></i>
<input
type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:">
<button
class="search" type="submit"><i
class="icon-search"></i></button></div></form></div></div>
</header><div
class="main-content"><div
class="container"><div
id="content" class="main-content-inner"><div
class="row"><div
class="col-sm-12 col-md-9">
<article
id="post-702" class="post-702 post type-post status-publish format-standard has-post-thumbnail hentry category-blog category-data-science category-pandas category-python category-tutorials tag-data tag-data-science tag-data-wrangling tag-dataframe tag-datascience tag-join tag-joining tag-merge tag-merging tag-pandas tag-processing tag-python tag-sql"><div
class="row"><div
class="post-meta-info col-sm-12 col-md-2"><div
class="entry-meta">
<time
class="entry-time updated" itemprop="datePublished" datetime="2017-03-05T15:14:55+00:00">Mar<strong>05</strong></time>
<span
class="comments_count clearfix entry-comments-link"><a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comments">9</a></span></div></div><div
class="post-content-wrap col-sm-12 col-md-10">
<header
class="page-header"><h1 class="entry-title">Merge and Join DataFrames with Pandas in Python</h1>
<span
class="entry-author">
Posted by			<span
class="author vcard entry-author-link">
<a
href="https://www.shanelynn.ie/author/shanelynn/" title="Posts by shanelynn" rel="author">shanelynn</a>			</span>
</span>
</header><div
class="entry-content">
<figure>
<a
class="swipebox" href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background.jpg" title="Merge and Join DataFrames with Pandas in Python">
<img
width="732" height="163" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background-732x163.jpg" class="attachment-blog-page size-blog-page wp-post-image" alt="merging tutorial for pandas part 1" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background-732x163.jpg 732w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background-300x67.jpg 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background-768x171.jpg 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background.jpg 950w" sizes="(max-width: 732px) 100vw, 732px" data-attachment-id="793" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/data-merge-join-background/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background.jpg" data-orig-size="950,212" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="data-merge-join-background" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background-300x67.jpg" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/data-merge-join-background.jpg" />			    </a>
</figure><p>In any real world data science situation with <a
href="http://Python">Python</a>, you’ll be about 10 minutes in when you’ll need to merge or join <a
href="http://pandas.pydata.org">Pandas</a> Dataframes together to form your analysis dataset. <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html">Merging and joining dataframes</a> is a core process that any aspiring data analyst will need to master. This blog post addresses the process of merging datasets, that is, joining two datasets together based on common columns between them. Key topics covered here:</p><ul><li><a
href="#whatis">What is a merge or join of two dataframes</a>?</li><li><a
href="#mergetypes">What are inner, outer, left and right merges</a>?</li><li><a
href="#differentnames">How do I merge two dataframes with different common column names? (left_on and right_on syntax)</a></li></ul><p>If you’d like to work through the tutorial yourself, I’m using a <a
href="http://jupyter.org/">Jupyter notebook</a> setup with <a
href="https://www.continuum.io/downloads">Python 3.5.2 from Anaconda</a>, and I’ve posted the code on GitHub here. I’ve included the sample datasets in the GitHub repository.</p><p><span
id="more-702"></span></p><div
id="attachment_789" style="width: 810px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png"><img
data-attachment-id="789" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-join-different-variable-names-copy/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" data-orig-size="800,240" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-join-different-variable-names" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-300x90.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" class="size-full wp-image-789" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" alt="You can merge data sets with different join variable names in each." width="800" height="240"></a><p
class="wp-caption-text">Merging overview if you need a quickstart (all explanations below)! The Pandas merge() command takes the left and right dataframes, matches rows based on the “on” columns, and performs different types of merges – left, right, etc.</p></div><h2>Example data</h2><p>For this post, I have taken some real data from the <a
href="http://www.killbiller.com">KillBiller application</a> and some downloaded data, contained in three CSV files:</p><ul><li><a
href="https://github.com/shanealynn/Pandas-Merge-Tutorial/blob/master/user_usage.csv">user_usage.csv</a> – A first dataset containing users monthly mobile usage statistics</li><li><a
href="https://github.com/shanealynn/Pandas-Merge-Tutorial/blob/master/user_device.csv">user_device.csv</a> – A second dataset containing details of an individual “use” of the system, with dates and device information.</li><li><a
href="https://github.com/shanealynn/Pandas-Merge-Tutorial/blob/master/android_devices.csv">android_devices.csv</a> – A third dataset with device and manufacturer data, which lists all Android devices and their model code, obtained from Google <a
href="https://support.google.com/googleplay/answer/1727131?hl=en-GB">here</a>.</li></ul><p>We can load these CSV files as <a
href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html?highlight=dataframe" target="_blank">Pandas DataFrames</a> into pandas using the Pandas <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html" target="_blank">read_csv</a> command, and examine the contents using the <a
href="http://pandas.pydata.org/pandas-docs/stable/basics.html#basics">DataFrame head()</a> command.</p><div
id="attachment_759" style="width: 728px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head.png"><img
data-attachment-id="759" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_user_usage_head/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head.png" data-orig-size="718,234" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas_merge_user_usage_head" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head-300x98.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head.png" class="size-full wp-image-759" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head.png" alt="" width="718" height="234" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head.png 718w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_usage_head-300x98.png 300w" sizes="(max-width: 718px) 100vw, 718px"></a><p
class="wp-caption-text">Sample usage information from the KillBiller application showing monthly mobile usage statistics for a subset of users.</p></div><div
id="attachment_758" style="width: 730px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head.png"><img
data-attachment-id="758" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_user_device_head/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head.png" data-orig-size="720,234" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas_merge_user_device_head" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head-300x98.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head.png" class="size-full wp-image-758" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head.png" alt="" width="720" height="234" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head.png 720w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_user_device_head-300x98.png 300w" sizes="(max-width: 720px) 100vw, 720px"></a><p
class="wp-caption-text">User information from KillBiller application giving the device and OS version for individual “uses” of the KillBiller application.</p></div><div
id="attachment_757" style="width: 717px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head.png"><img
data-attachment-id="757" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_devices_head/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head.png" data-orig-size="707,455" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas_merge_devices_head" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head-300x193.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head.png" class="size-full wp-image-757" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head.png" alt="" width="707" height="455" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head.png 707w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_devices_head-300x193.png 300w" sizes="(max-width: 707px) 100vw, 707px"></a><p
class="wp-caption-text">Android Device data, containing all Android devices with manufacturer and model details.</p></div><p>There are linking attributes between the sample datasets that are important to note – “use_id” is shared between the user_usage and user_device, and the “device” column of user_device and “Model” column of the devices dataset contain common codes.</p><h2>Sample problem</h2><p>We would like to determine if the usage patterns for users differ between different devices. For example, do users using <a
href="http://www.samsung.com/ie/" target="_blank">Samsung</a> devices use more call minutes than those using  <a
href="http://www.lg.com/uk" target="_blank">LG</a> devices? This is a toy problem given the small sample size in these dataset, but is a perfect example of where merges are required.</p><p>We want to form a single dataframe with columns for user usage figures (calls per month, sms per month etc) and also columns with device information (model, manufacturer, etc). We will need to “merge” (or “join”) our sample datasets together into one single dataset for analysis.</p><div
class="shane-content" style="margin-left: auto; margin-right: auto; width: 336px; height: 280px; " id="shane-16306952"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins
class="adsbygoogle" style="display:inline-block;width:336px;height:280px;" data-ad-client="ca-pub-2568178699868194" data-ad-slot="4606931263"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><h2 id="whatis">Merging DataFrames</h2><blockquote><p>“Merging” two datasets is the process of bringing two datasets together into one, and aligning the rows from each based on common attributes or columns.</p></blockquote><p>The words “merge” and “join” are used relatively interchangeably in Pandas and other languages, namely <a
href="https://en.wikipedia.org/wiki/SQL" target="_blank">SQL</a> and <a
href="https://en.wikipedia.org/wiki/R_(programming_language)" target="_blank">R</a>. In Pandas, there are separate “<a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.merge.html" target="_blank">merge</a>” and “<a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.join.html?highlight=join#pandas.DataFrame.join" target="_blank">join</a>” functions, both of which do similar things.</p><p>In this example scenario, we will need to perform two steps:</p><div
class="shane-content-1" style="margin-left: auto; margin-right: auto; margin-top: 10px; margin-bottom: 10px; width: 336px; height: 280px; " id="shane-358353211"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins
class="adsbygoogle" style="display:inline-block;width:336px;height:280px;" data-ad-client="ca-pub-2568178699868194" data-ad-slot="6964968463"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><ol><li>For each row in the user_usage dataset – make a new column that contains the “device” code from the user_devices dataframe. i.e. for the first row, the use_id is 22787, so we go to the user_devices dataset, find the use_id 22787, and copy the value from the “device” column across.</li><li>After this is complete, we take the new device columns, and we find the corresponding “Retail Branding” and “Model” from the devices dataset.</li><li>Finally, we can look at different statistics for usage <a
href="https://www.shanelynn.ie/summarising-aggregation-and-grouping-data-in-python-pandas/">splitting and grouping data</a> by the device manufacturers used.</li></ol><h3>Can I use a for loop?</h3><p>Yes. You could write for loops for this task. The first would loop through the use_id in the user_usage dataset, and then find the right element in user_devices. The second for loop will repeat this process for the devices.</p><p>However, using for loops will be much slower and more verbose than using Pandas merge functionality. So,  if you come across this situation – <strong>don’t use for loops</strong>.</p><h2>Merging user_usage with user_devices</h2><p>Lets see how we can correctly add the “device” and “platform” columns to the user_usage dataframe using the <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html">Pandas Merge</a> command.</p><div
id="crayon-5af86aeb77f7f442089309" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result = pd.merge(user_usage,
                 user_device[['use_id', 'platform', 'device']],
                 on='use_id')
result.head()</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77f7f442089309-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77f7f442089309-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77f7f442089309-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77f7f442089309-4">4</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77f7f442089309-1"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">user_usage</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77f7f442089309-2"><span
class="crayon-h">                 </span><span
class="crayon-v">user_device</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'platform'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'device'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77f7f442089309-3"><span
class="crayon-h">                 </span><span
class="crayon-v">on</span><span
class="crayon-o">=</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77f7f442089309-4"><span
class="crayon-v">result</span><span
class="crayon-sy">.</span><span
class="crayon-e">head</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p> </p><div
id="attachment_762" style="width: 819px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1.png"><img
data-attachment-id="762" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_result_1/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1.png" data-orig-size="809,281" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="Pandas Merging devices and usage result" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1-300x104.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1.png" class="size-full wp-image-762" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1.png" alt="" width="809" height="281" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1.png 809w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1-300x104.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1-768x267.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pandas_merge_result_1-732x254.png 732w" sizes="(max-width: 809px) 100vw, 809px"></a><p
class="wp-caption-text">Result of merging user usage with user devices based on a common column.</p></div><p>So that works, and very easily! Now – how did that work? What was the pd.merge command doing?</p><div
id="attachment_767" style="width: 860px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pd-merge_intro_image.png"><img
data-attachment-id="767" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pd-merge_intro_image/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pd-merge_intro_image-e1488724380571.png" data-orig-size="850,286" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pd merge_intro_image" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pd-merge_intro_image-300x101.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pd-merge_intro_image-e1488724380571.png" class="wp-image-767 size-full" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/pd-merge_intro_image-e1488724380571.png" alt="Pandas merging explained with a breakdown of the command parameters." width="850" height="286"></a><p
class="wp-caption-text">How Pandas Merge commands work. At the very least, merging requires a “left” dataset, a “right” dataset, and a common column to merge “on”.</p></div><p>The merge command is the key learning objective of this post. The merging operation at its simplest takes a left dataframe (the first argument), a right dataframe (the second argument), and then a merge column name, or a column to merge “on”. In the output/result, rows from the left and right dataframes are matched up where there are common values of the merge column specified by “on”.</p><p>With this result, we can now move on to get the manufacturer and model number from the “devices” dataset. However, first we need to understand a little more about merge types and the sizes of the output dataframe.</p><h2>Inner, Left, and right merge types</h2><p>In our example above, we merged user_usage with user_devices. The <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html" target="_blank">head</a>() preview of the result looks great, but there’s more to this than meets the eye. First, let’s look at the <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.shape.html" target="_blank">sizes or shapes</a> of our inputs and outputs to the merge command:</p><div
id="attachment_769" style="width: 919px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge.png"><img
data-attachment-id="769" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/dataset_sizes_after_merge/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge.png" data-orig-size="909,155" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="dataset_sizes_after_merge" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge-300x51.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge.png" class="size-full wp-image-769" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge.png" alt="" width="909" height="155" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge.png 909w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge-300x51.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge-768x131.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/02/dataset_sizes_after_merge-732x125.png 732w" sizes="(max-width: 909px) 100vw, 909px"></a><p
class="wp-caption-text">The resultant size of the dataset after the merge operation may not be as expected. Pandas merge() defaults to an “inner” merge operation.</p></div><p>Why is the result a different size to both the original dataframes?</p><p>By default, the <a
href="http://pandas.pydata.org/pandas-docs/stable/merging.html" target="_blank">Pandas merge operation </a>acts with an “inner” merge. An inner merge, (or inner join) keeps only the common values in both the left and right dataframes for the result. In our example above, only the rows that contain use_id values that are common between user_usage and user_device remain in the result dataset. We can validate this by looking at how many values are common:</p><div
id="attachment_773" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_blog_use_id_values-1.png"><img
data-attachment-id="773" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_blog_use_id_values-2/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_blog_use_id_values-1-e1488724649342.png" data-orig-size="800,130" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas_merge_blog_use_id_values" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_blog_use_id_values-1-300x49.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_blog_use_id_values-1-1024x167.png" class="wp-image-773 size-large" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_blog_use_id_values-1-1024x167.png" alt="Merging by default in Python Pandas results in an inner merge" width="750" height="122"></a><p
class="wp-caption-text">Only common values between the left and right dataframes are retained by default in Pandas, i.e. an “inner” merge is used.</p></div><p>There are 159 values of use_id in the user_usage table that appear in user_device. These are the same values that also appear in the final result dataframe (159 rows).</p><h3 id="mergetypes">Other Merge Types</h3><p>There are three different types of merges available in Pandas. These merge types are common across most database and data-orientated languages (<a
href="https://www.w3schools.com/sql/sql_join.asp">SQL</a>, <a
href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/merge.html">R</a>, <a
href="https://www.analyticsvidhya.com/blog/2015/01/introduction-merging-sas/">SAS</a>) and are typically referred to as “joins”. If you don’t know them, learn them now.</p><ol><li><strong>Inner Merge / Inner join</strong> – The default Pandas behaviour, only keep rows where the merge “on” value exists in both the left and right dataframes.</li><li><strong>Left Merge / Left outer join</strong> – (aka left merge or left join) Keep every row in the left dataframe. Where there are missing values of the “on” variable in the right dataframe, add empty / NaN values in the result.</li><li><strong>Right Merge</strong> / <strong>Right outer join</strong> – (aka right merge or right join) Keep every row in the right dataframe. Where there are missing values of the “on” variable in the left column, add empty / NaN values in the result.</li><li><strong>Outer Merge / Full outer join – </strong>A full outer join returns all the rows from the left dataframe, all the rows from the right dataframe, and matches up rows where possible, with NaNs elsewhere.</li></ol><p>The merge type to use is specified using the “how” parameter in the merge command, taking values “left”, “right”, “inner” (default), or “outer”.</p><p>Venn diagrams are commonly used to exemplify the different merge and join types. See this example from <a
href="http://stackoverflow.com/questions/38549/what-is-the-difference-between-inner-join-and-outer-join" target="_blank">Stack overflow</a>:</p><div
id="attachment_772" style="width: 610px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names.jpg"><img
data-attachment-id="772" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/join-types-merge-names/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names.jpg" data-orig-size="600,300" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="join-types-merge-names" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names-300x150.jpg" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names.jpg" class="size-full wp-image-772" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names.jpg" alt="Merges and joins are used to bring datasets together based on common values." width="600" height="300" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names.jpg 600w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/join-types-merge-names-300x150.jpg 300w" sizes="(max-width: 600px) 100vw, 600px"></a><p
class="wp-caption-text">Merge/Join types as used in Pandas, R, SQL, and other data-orientated languages and libraries. Source: Stack Overflow.</p></div><p>If this is new to you, or you are looking at the above with a frown, take the time to watch this video on <a
href="https://www.coursera.org/learn/python-data-analysis/lecture/08sf6/merging-dataframes" target="_blank">“merging dataframes” from Coursera</a> for another explanation that might help. We’ll now look at each merge type in more detail, and work through examples of each.</p><h3>Example of left merge / left join</h3><p>Let’s repeat our merge operation, but this time perform a “left merge” in Pandas.</p><ul><li>Originally, the result dataframe had 159 rows, because there were 159 values of “use_id” common between our left and right dataframes and an “inner” merge was used by default.</li><li>For our left merge, we expect the result to have the same number of rows as our left dataframe “user_usage” (240), with missing values for all but 159 of the merged “platform” and “device” columns (81 rows).</li><li>We expect the result to have the same number of rows as the left dataframe because each use_id in user_usage appears only once in user_device. A one-to-one mapping is not always the case. In merge operations where a single row in the left dataframe is matched by multiple rows in the right dataframe, multiple result rows will be generated. i.e. if a use_id value in user_usage appears twice in the user_device dataframe, there will be two rows for that use_id in the join result.</li></ul><p>You can change the merge to a left-merge with the “how” parameter to your merge command. The top of the result dataframe contains the successfully matched items, and at the bottom contains the rows in user_usage that didn’t have a corresponding use_id in user_device.</p><div
id="crayon-5af86aeb77f95782629860" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result = pd.merge(user_usage,
                 user_device[['use_id', 'platform', 'device']],
                 on='use_id', 
                 how='left')</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77f95782629860-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77f95782629860-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77f95782629860-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77f95782629860-4">4</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77f95782629860-1"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">user_usage</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77f95782629860-2"><span
class="crayon-h">                 </span><span
class="crayon-v">user_device</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'platform'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'device'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77f95782629860-3"><span
class="crayon-h">                 </span><span
class="crayon-v">on</span><span
class="crayon-o">=</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77f95782629860-4"><span
class="crayon-h">                 </span><span
class="crayon-v">how</span><span
class="crayon-o">=</span><span
class="crayon-s">'left'</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p></p><div
id="attachment_774" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example.png"><img
data-attachment-id="774" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas_merge_left_example/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example.png" data-orig-size="1370,432" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-left-example" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-300x95.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-1024x323.png" class="wp-image-774 size-large" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-1024x323.png" alt="left joining is a common merge type in python and r" width="750" height="237" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-1024x323.png 1024w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-300x95.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-768x242.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-732x231.png 732w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example-1140x359.png 1140w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas_merge_left_example.png 1370w" sizes="(max-width: 750px) 100vw, 750px"></a><p
class="wp-caption-text">Left join example in pandas. Specify the join type in the “how” command. A left join, or left merge, keeps every row from the left dataframe.</p></div><div
id="attachment_777" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result.png"><img
data-attachment-id="777" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-left-join-result/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result.png" data-orig-size="1818,928" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-left-join-result" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-300x153.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-1024x523.png" class="size-large wp-image-777" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-1024x523.png" alt="left joining or left merging is used to find corresponding values in the right dataframe, while keeping all rows from the left." width="750" height="383" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-1024x523.png 1024w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-300x153.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-768x392.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-732x374.png 732w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-left-join-result-1140x582.png 1140w" sizes="(max-width: 750px) 100vw, 750px"></a><p
class="wp-caption-text">Result from left-join or left-merge of two dataframes in Pandas. Rows in the left dataframe that have no corresponding join value in the right dataframe are left with NaN values.</p></div><h3>Example of right merge / right join</h3><p>For examples sake, we can repeat this process with a right join / right merge, simply by replacing <em>how=’left’</em> with <em>how=’right’</em> in the Pandas merge command.</p><div
id="crayon-5af86aeb77fa9545464645" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result = pd.merge(user_usage,
                 user_device[['use_id', 'platform', 'device']],
                 on='use_id', 
                 how='right')</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77fa9545464645-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fa9545464645-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77fa9545464645-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fa9545464645-4">4</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77fa9545464645-1"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">user_usage</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fa9545464645-2"><span
class="crayon-h">                 </span><span
class="crayon-v">user_device</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'platform'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'device'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fa9545464645-3"><span
class="crayon-h">                 </span><span
class="crayon-v">on</span><span
class="crayon-o">=</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fa9545464645-4"><span
class="crayon-h">                 </span><span
class="crayon-v">how</span><span
class="crayon-o">=</span><span
class="crayon-s">'right'</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p>The result expected will have the same number of rows as the right dataframe, user_device, but have several empty, or NaN values in the columns originating in the left dataframe, user_usage (namely “outgoing_mins_per_month”, “outgoing_sms_per_month”, and “monthly_mb”). Conversely, we expect no missing values in the columns originating in the right dataframe, “user_device”.</p><div
id="attachment_778" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values.png"><img
data-attachment-id="778" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-right-dataframe-result-missing-values/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values.png" data-orig-size="1808,540" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-right-dataframe-result-missing -values" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-300x90.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-1024x306.png" class="size-large wp-image-778" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-1024x306.png" alt='right merge in pandas keeps all rows from the second, "right" dataframe.' width="750" height="224" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-1024x306.png 1024w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-300x90.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-768x229.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-732x219.png 732w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-right-dataframe-result-missing-values-1140x340.png 1140w" sizes="(max-width: 750px) 100vw, 750px"></a><p
class="wp-caption-text">Example of a right merge, or right join. Note that the output has the same number of rows as the right dataframe, with missing values only where use_id in the left dataframe didn’t match anything in the left.</p></div><h3>Example of outer merge / full outer join</h3><p>Finally, we will perform an <a
href="https://www.w3schools.com/Sql/sql_join_full.asp" target="_blank">outer merge</a> using Pandas, also referred to as a “full outer join” or just “outer join”. An outer join can be seen as a combination of left and right joins, or the opposite of an inner join. In outer joins, every row from the left and right dataframes is retained in the result, with NaNs where there are no matched join variables.</p><p>As such, we would expect the results to have the same number of rows as there are distinct values of “use_id” between user_device and user_usage, i.e. every join value from the left dataframe will be in the result along with every value from the right dataframe, and they’ll be linked where possible.</p><div
id="attachment_779" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-result-e1488446880892.png"><img
data-attachment-id="779" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-outer-join-result/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-result-e1488446880892.png" data-orig-size="750,222" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-outer-join-result" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-result-300x89.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-result-1024x303.png" class="size-large wp-image-779" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-result-1024x303.png" alt="pandas outer merge result retains all rows." width="750" height="222"></a><p
class="wp-caption-text">Outer merge result using Pandas. Every row from the left and right dataframes is retained in the result, with missing values or numpy NaN values where the merge column doesn’t match.</p></div><p>In the diagram below, example rows from the outer merge result are shown, the first two are examples where the “use_id” was common between the dataframes, the second two originated only from the left dataframe, and the final two originated only from the right dataframe.</p><h3>Using merge indicator to track merges</h3><p>To assist with the identification of where rows originate from, Pandas provides an <a
href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html">“indicator” parameter</a> that can be used with the merge function which creates an additional column called “_merge” in the output that labels the original source for each row.</p><div
id="crayon-5af86aeb77fb5738550715" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result = pd.merge(user_usage,
                 user_device[['use_id', 'platform', 'device']],
                 on='use_id', 
                 how='outer', 
                 indicator=True)</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77fb5738550715-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fb5738550715-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77fb5738550715-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fb5738550715-4">4</div><div
class="crayon-num" data-line="crayon-5af86aeb77fb5738550715-5">5</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77fb5738550715-1"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">user_usage</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fb5738550715-2"><span
class="crayon-h">                 </span><span
class="crayon-v">user_device</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'platform'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'device'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fb5738550715-3"><span
class="crayon-h">                 </span><span
class="crayon-v">on</span><span
class="crayon-o">=</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fb5738550715-4"><span
class="crayon-h">                 </span><span
class="crayon-v">how</span><span
class="crayon-o">=</span><span
class="crayon-s">'outer'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span></div><div
class="crayon-line" id="crayon-5af86aeb77fb5738550715-5"><span
class="crayon-h">                 </span><span
class="crayon-v">indicator</span><span
class="crayon-o">=</span><span
class="crayon-t">True</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p></p><div
id="attachment_782" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-example-1.png"><img
data-attachment-id="782" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-outer-join-example-2/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-example-1-e1488496954294.png" data-orig-size="1000,349" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-outer-join-example" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-example-1-300x105.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-example-1-1024x357.png" class="wp-image-782 size-large" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-outer-join-example-1-1024x357.png" alt="outer join or merges in pandas result in one row for each unique value of the join variable." width="750" height="261"></a><p
class="wp-caption-text">Example rows from outer merge (full outer join) result. Note that all rows from left and right merge dataframes are included, but NaNs will be in different columns depending if the data originated in the left or right dataframe.</p></div><h2>Final Merge – Joining device details to result</h2><p>Coming back to our original problem, we have already merged user_usage with user_device, so we have the platform and device for each user. Originally, we used an “<a
href="https://www.w3schools.com/Sql/sql_join_inner.asp" target="_blank">inner merge</a>” as the default in Pandas, and as such, we only have entries for users where there is also device information. We’ll redo this merge using a left join to keep all users, and then use a second left merge to finally to get the device manufacturers in the same dataframe.</p><div
id="crayon-5af86aeb77fbd991944953" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# First, add the platform and device to the user usage - use a left join this time.
result = pd.merge(user_usage,
                 user_device[['use_id', 'platform', 'device']],
                 on='use_id',
                 how='left')

# At this point, the platform and device columns are included
# in the result along with all columns from user_usage

# Now, based on the "device" column in result, match the "Model" column in devices.
devices.rename(columns={"Retail Branding": "manufacturer"}, inplace=True)
result = pd.merge(result, 
                  devices[['manufacturer', 'Model']],
                  left_on='device',
                  right_on='Model',
                  how='left')
print(result.head())</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-4">4</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-5">5</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-6">6</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-7">7</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-8">8</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-9">9</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-10">10</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-11">11</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-12">12</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-13">13</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-14">14</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-15">15</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fbd991944953-16">16</div><div
class="crayon-num" data-line="crayon-5af86aeb77fbd991944953-17">17</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-1"><span
class="crayon-c"># First, add the platform and device to the user usage - use a left join this time.</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-2"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">user_usage</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-3"><span
class="crayon-h">                 </span><span
class="crayon-v">user_device</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'platform'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'device'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-4"><span
class="crayon-h">                 </span><span
class="crayon-v">on</span><span
class="crayon-o">=</span><span
class="crayon-s">'use_id'</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-5"><span
class="crayon-h">                 </span><span
class="crayon-v">how</span><span
class="crayon-o">=</span><span
class="crayon-s">'left'</span><span
class="crayon-sy">)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-6"> </div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-7"><span
class="crayon-c"># At this point, the platform and device columns are included</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-8"><span
class="crayon-c"># in the result along with all columns from user_usage</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-9"> </div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-10"><span
class="crayon-c"># Now, based on the "device" column in result, match the "Model" column in devices.</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-11"><span
class="crayon-v">devices</span><span
class="crayon-sy">.</span><span
class="crayon-e">rename</span><span
class="crayon-sy">(</span><span
class="crayon-v">columns</span><span
class="crayon-o">=</span><span
class="crayon-sy">{</span><span
class="crayon-s">"Retail Branding"</span><span
class="crayon-o">:</span><span
class="crayon-h"> </span><span
class="crayon-s">"manufacturer"</span><span
class="crayon-sy">}</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-v">inplace</span><span
class="crayon-o">=</span><span
class="crayon-t">True</span><span
class="crayon-sy">)</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-12"><span
class="crayon-v">result</span><span
class="crayon-h"> </span><span
class="crayon-o">=</span><span
class="crayon-h"> </span><span
class="crayon-v">pd</span><span
class="crayon-sy">.</span><span
class="crayon-e">merge</span><span
class="crayon-sy">(</span><span
class="crayon-v">result</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-13"><span
class="crayon-h">                  </span><span
class="crayon-v">devices</span><span
class="crayon-sy">[</span><span
class="crayon-sy">[</span><span
class="crayon-s">'manufacturer'</span><span
class="crayon-sy">,</span><span
class="crayon-h"> </span><span
class="crayon-s">'Model'</span><span
class="crayon-sy">]</span><span
class="crayon-sy">]</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-14"><span
class="crayon-h">                  </span><span
class="crayon-v">left_on</span><span
class="crayon-o">=</span><span
class="crayon-s">'device'</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-15"><span
class="crayon-h">                  </span><span
class="crayon-v">right_on</span><span
class="crayon-o">=</span><span
class="crayon-s">'Model'</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fbd991944953-16"><span
class="crayon-h">                  </span><span
class="crayon-v">how</span><span
class="crayon-o">=</span><span
class="crayon-s">'left'</span><span
class="crayon-sy">)</span></div><div
class="crayon-line" id="crayon-5af86aeb77fbd991944953-17"><span
class="crayon-k ">print</span><span
class="crayon-sy">(</span><span
class="crayon-v">result</span><span
class="crayon-sy">.</span><span
class="crayon-e">head</span><span
class="crayon-sy">(</span><span
class="crayon-sy">)</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p></p><div
id="attachment_785" style="width: 760px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result.png"><img
data-attachment-id="785" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-final-merge-result/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result.png" data-orig-size="1900,378" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-final-merge-result" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-300x60.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-1024x204.png" class="size-large wp-image-785" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-1024x204.png" alt="" width="750" height="149" srcset="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-1024x204.png 1024w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-300x60.png 300w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-768x153.png 768w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-732x146.png 732w, https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-final-merge-result-1140x227.png 1140w" sizes="(max-width: 750px) 100vw, 750px"></a><p
class="wp-caption-text">Final merged result with device manufacturer information merged onto the user usage table. Two left merges were used to get to this point.</p></div><h3 id="differentnames">Using left_on and right_on to merge with different column names</h3><p>The columns used in a merge operator do not need to be named the same in both the left and right dataframe. In the second merge above, note that the device ID is called “device” in the left dataframe, and called “Model” in the right dataframe.</p><p>Different column names are specified for merges in Pandas using the “left_on” and “right_on” parameters, instead of using only the “on” parameter.</p><div
id="attachment_789" style="width: 810px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png"><img
data-attachment-id="789" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-join-different-variable-names-copy/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" data-orig-size="800,240" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-join-different-variable-names" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-300x90.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" class="size-full wp-image-789" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-join-different-variable-names-copy-e1488722312527.png" alt="You can merge data sets with different join variable names in each." width="800" height="240"></a><p
class="wp-caption-text">Merging dataframes with different names for the joining variable is achieved using the left_on and right_on arguments to the pandas merge function.</p></div><h2>Calculating statistics based on device</h2><p>With our merges complete, we can use the <a
href="https://www.shanelynn.ie/summarising-aggregation-and-grouping-data-in-python-pandas/" target="_blank">data aggregation functionality of Pandas</a> to quickly work out the mean usage for users based on device manufacturer. Note that the small sample size creates even smaller groups, so I wouldn’t attribute any statistical significance to these particular results!</p><div
id="crayon-5af86aeb77fc3648269553" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span
class="crayon-title"></span><div
class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div
class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-expand-button" title="Expand Code"><div
class="crayon-button-icon"></div></div><div
class="crayon-button crayon-popup-button" title="Open Code In New Window"><div
class="crayon-button-icon"></div></div><span
class="crayon-language">Python</span></div></div><div
class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div><div
class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result.groupby("manufacturer").agg({
        "outgoing_mins_per_month": "mean",
        "outgoing_sms_per_month": "mean",
        "monthly_mb": "mean",
        "use_id": "count"
    })</textarea></div><div
class="crayon-main" style=""><table
class="crayon-table"><tr
class="crayon-row"><td
class="crayon-nums " data-settings="show"><div
class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div
class="crayon-num" data-line="crayon-5af86aeb77fc3648269553-1">1</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fc3648269553-2">2</div><div
class="crayon-num" data-line="crayon-5af86aeb77fc3648269553-3">3</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fc3648269553-4">4</div><div
class="crayon-num" data-line="crayon-5af86aeb77fc3648269553-5">5</div><div
class="crayon-num crayon-striped-num" data-line="crayon-5af86aeb77fc3648269553-6">6</div></div></td><td
class="crayon-code"><div
class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div
class="crayon-line" id="crayon-5af86aeb77fc3648269553-1"><span
class="crayon-v">result</span><span
class="crayon-sy">.</span><span
class="crayon-e">groupby</span><span
class="crayon-sy">(</span><span
class="crayon-s">"manufacturer"</span><span
class="crayon-sy">)</span><span
class="crayon-sy">.</span><span
class="crayon-e">agg</span><span
class="crayon-sy">(</span><span
class="crayon-sy">{</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fc3648269553-2"><span
class="crayon-h">        </span><span
class="crayon-s">"outgoing_mins_per_month"</span><span
class="crayon-o">:</span><span
class="crayon-h"> </span><span
class="crayon-s">"mean"</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fc3648269553-3"><span
class="crayon-h">        </span><span
class="crayon-s">"outgoing_sms_per_month"</span><span
class="crayon-o">:</span><span
class="crayon-h"> </span><span
class="crayon-s">"mean"</span><span
class="crayon-sy">,</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fc3648269553-4"><span
class="crayon-h">        </span><span
class="crayon-s">"monthly_mb"</span><span
class="crayon-o">:</span><span
class="crayon-h"> </span><span
class="crayon-s">"mean"</span><span
class="crayon-sy">,</span></div><div
class="crayon-line" id="crayon-5af86aeb77fc3648269553-5"><span
class="crayon-h">        </span><span
class="crayon-s">"use_id"</span><span
class="crayon-o">:</span><span
class="crayon-h"> </span><span
class="crayon-s">"count"</span></div><div
class="crayon-line crayon-striped-line" id="crayon-5af86aeb77fc3648269553-6"><span
class="crayon-h">    </span><span
class="crayon-sy">}</span><span
class="crayon-sy">)</span></div></div></td></tr></table></div></div><p> </p><div
id="attachment_790" style="width: 810px" class="wp-caption aligncenter"><a
href="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-statistics-result.png"><img
data-attachment-id="790" data-permalink="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/pandas-merge-statistics-result/#main" data-orig-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-statistics-result-e1488723613744.png" data-orig-size="800,454" data-comments-opened="1" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title="pandas-merge-statistics-result" data-image-description="" data-medium-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-statistics-result-300x170.png" data-large-file="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-statistics-result-e1488723613744.png" class="wp-image-790 size-full" src="https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/2017/03/pandas-merge-statistics-result-e1488723613744.png" alt="Groupby statistics can be calculated using the groupby and agg Pandas functions." width="800" height="454"></a><p
class="wp-caption-text">Final result using agg() pandas aggregation to group by device manufacturer and work out mean statistics for different columns.</p></div><h2>Becoming a master of merging – Part 2</h2><p>That completes the first part of this merging tutorial. You should now have conquered the basics of merging, and be able to tackle your own merging and joining problems with the information above. Part 2 of this blog post addresses the following more advanced topics:</p><ul><li>How do you merge dataframes using multiple join /common columns?</li><li>How do you merge dataframes based on the index of the dataframe?</li><li>What is the difference between the merge and join fucntions in Pandas?</li><li>How fast are merges in Python Pandas?</li></ul><h2>Other useful resources</h2><p>Don’t let your merging mastery stop here. Try the following links for further explanations and information on the topic:</p><ul><li><a
href="http://chrisalbon.com/python/pandas_join_merge_dataframe.html" target="_blank">Join and Merge Dataframes</a> examples by Chris Albon.</li><li><a
href="http://pandas.pydata.org/pandas-docs/stable/merging.html" target="_blank">Merge, join, and concatenate</a> official reference documentation from Pandas.</li><li><a
href="http://www.datacarpentry.org/python-ecology-lesson/04-merging-data/" target="_blank">Combining DataFrames with Pandas</a> on “Python for Ecologists” by DataCarpentry</li><li><a
href="https://www.youtube.com/watch?v=XMjSGGej9y8" target="_blank">YouTube tutorial on Joining and Merging Dataframes</a> by “sentdex”</li><li><a
href="http://wesmckinney.com/blog/high-performance-database-joins-with-pandas-dataframe-more-benchmarks/" target="_blank">High performance database joins with Pandas</a>, a comparison of merge speeds  by Wes McKinney, creator of Pandas.</li><li><a
href="https://www.w3schools.com/sql/sql_join.asp" target="_blank">SQL Join tutorial</a> on W3Schools</li><li><a
href="http://www.dofactory.com/sql/join" target="_blank">SQL Join tutorial</a> on DoFactory</li><li><a
href="http://pandas.pydata.org/pandas-docs/stable/comparison_with_sql.html#join" target="_blank">Comparing pandas merge with SQL</a> in official Pandas documentation.</li></ul><p> </p><div
id="jp-relatedposts" class="jp-relatedposts"><h3 class="jp-relatedposts-headline"><em>Related</em></h3></div></div>
<footer
class="footer-meta"><div
class="cat-tag-meta-wrap">
<span
class="cats-meta"><i
class="fa fa-folder"></i> <a
href="https://www.shanelynn.ie/category/blog/" rel="category tag">blog</a>, <a
href="https://www.shanelynn.ie/category/blog/data-science/" rel="category tag">data science</a>, <a
href="https://www.shanelynn.ie/category/pandas/" rel="category tag">Pandas</a>, <a
href="https://www.shanelynn.ie/category/blog/python/" rel="category tag">python</a>, <a
href="https://www.shanelynn.ie/category/tutorials/" rel="category tag">Tutorials</a></span>
<span
class="tags-meta"><i
class="fa fa-tags"></i> <a
href="https://www.shanelynn.ie/tag/data/" rel="tag">data</a>, <a
href="https://www.shanelynn.ie/tag/data-science/" rel="tag">data science</a>, <a
href="https://www.shanelynn.ie/tag/data-wrangling/" rel="tag">data wrangling</a>, <a
href="https://www.shanelynn.ie/tag/dataframe/" rel="tag">dataframe</a>, <a
href="https://www.shanelynn.ie/tag/datascience/" rel="tag">datascience</a>, <a
href="https://www.shanelynn.ie/tag/join/" rel="tag">join</a>, <a
href="https://www.shanelynn.ie/tag/joining/" rel="tag">joining</a>, <a
href="https://www.shanelynn.ie/tag/merge/" rel="tag">merge</a>, <a
href="https://www.shanelynn.ie/tag/merging/" rel="tag">merging</a>, <a
href="https://www.shanelynn.ie/tag/pandas/" rel="tag">pandas</a>, <a
href="https://www.shanelynn.ie/tag/processing/" rel="tag">processing</a>, <a
href="https://www.shanelynn.ie/tag/python/" rel="tag">python</a>, <a
href="https://www.shanelynn.ie/tag/sql/" rel="tag">sql</a></span></div>
</footer></div></div>
</article>
<nav
role="navigation" id="nav-below" class="post-navigation"><h1 class="screen-reader-text">Post navigation</h1><ul
class="pager"><li
class="nav-previous previous"><a
href="https://www.shanelynn.ie/batch-geocoding-in-python-with-google-geocoding-api/" rel="prev"><span
class="meta-nav">&larr;</span> Batch CSV Geocoding in Python with Google Maps API</a></li><li
class="nav-next next"><a
href="https://www.shanelynn.ie/using-big-data-to-create-better-mobile-video-games/" rel="next">Using big data to create better mobile video games <span
class="meta-nav">&rarr;</span></a></li></ul>
</nav><div
id="comments" class="comments-area">
<header
class="page-header"><h2 class="comments-title">
9 thoughts on &ldquo;<span>Merge and Join DataFrames with Pandas in Python</span>&rdquo;</h2>
</header><ol
class="comment-list media-list"><li
id="comment-553" class="comment even thread-even depth-1 parent">
<article
id="div-comment-553" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Mohamed</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-553">
<time
class="updated" datetime="2017-10-24T10:33:44+00:00">
October 24, 2017 at 10:33 am				</time>
</a></div></div><div
class="comment-content"><p>Thank you for this tutorial ! Really useful and practical.<br
/>
Where is the second part of this tutorial ? You talk about a second part but i didn&#8217;t find .. maybe it&#8217;s me.</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=553#respond' onclick='return addComment.moveForm( "div-comment-553", "553", "respond", "702" )' aria-label='Reply to Mohamed'>Reply</a></div></div></div>
</article><ul
class="children"><li
id="comment-557" class="comment byuser comment-author-shanelynn bypostauthor odd alt depth-2">
<article
id="div-comment-557" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">shanelynn</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-557">
<time
class="updated" datetime="2017-10-31T11:12:25+00:00">
October 31, 2017 at 11:12 am				</time>
</a></div></div><div
class="comment-content"><p>Hi Mohamed, I&#8217;m glad you liked it. Unfortunately the second part is a &#8220;work in progress!&#8221; and time is short at the moment. Though hopefully I&#8217;ll upload it in the coming weeks!</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=557#respond' onclick='return addComment.moveForm( "div-comment-557", "557", "respond", "702" )' aria-label='Reply to shanelynn'>Reply</a></div></div></div>
</article></li></ul></li><li
id="comment-578" class="comment even thread-odd thread-alt depth-1">
<article
id="div-comment-578" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Nimit Gupta</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-578">
<time
class="updated" datetime="2017-12-04T17:32:58+00:00">
December 4, 2017 at 5:32 pm				</time>
</a></div></div><div
class="comment-content"><p>Hi, Wow!, What an indepth tutorial on Pandas Merge(), and way best, than offical Pandas documentation, and any other online resources. #ManyThanks for writing it, and looking foward for Part 2 of it. #ThanksOnceAgain</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=578#respond' onclick='return addComment.moveForm( "div-comment-578", "578", "respond", "702" )' aria-label='Reply to Nimit Gupta'>Reply</a></div></div></div>
</article></li><li
id="comment-590" class="pingback odd alt thread-even depth-1 media"><div
class="comment-body">
Pingback: <a
href='https://www.shanelynn.ie/using-pandas-dataframe-creating-editing-viewing-data-in-python/' rel='external nofollow' class='url'>Python Pandas DataFrame: load, edit, view data | Shane Lynn</a></div></li><li
id="comment-595" class="comment even thread-odd thread-alt depth-1">
<article
id="div-comment-595" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Armando V Ochoa Sanchez</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-595">
<time
class="updated" datetime="2017-12-28T17:19:20+00:00">
December 28, 2017 at 5:19 pm				</time>
</a></div></div><div
class="comment-content"><p>Great material, thank you!! I&#8217;m waiting for the second part.<br
/>
Right now I&#8217;m struggling with the merge of two complementary data frames, each of them have the same columns names and number, but one has NaN values where the other one as NON-NaN. Do you have any idea of how to merge them keeping only the NON-NaN values?</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=595#respond' onclick='return addComment.moveForm( "div-comment-595", "595", "respond", "702" )' aria-label='Reply to Armando V Ochoa Sanchez'>Reply</a></div></div></div>
</article></li><li
id="comment-597" class="comment odd alt thread-even depth-1">
<article
id="div-comment-597" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Martin Bebow</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-597">
<time
class="updated" datetime="2018-01-01T17:29:43+00:00">
January 1, 2018 at 5:29 pm				</time>
</a></div></div><div
class="comment-content"><p>Like I emailed you, you should have a place for those of us who feel like making a donation to your efforts.  This  tutorial is beautifully simple to understand and I want to encourage you and others like you to keep up the good work.  I also am waiting for part 2.</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=597#respond' onclick='return addComment.moveForm( "div-comment-597", "597", "respond", "702" )' aria-label='Reply to Martin Bebow'>Reply</a></div></div></div>
</article></li><li
id="comment-623" class="comment even thread-odd thread-alt depth-1 parent">
<article
id="div-comment-623" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Saraa</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-623">
<time
class="updated" datetime="2018-01-25T01:18:39+00:00">
January 25, 2018 at 1:18 am				</time>
</a></div></div><div
class="comment-content"><p>Great help, thank you very much Shane! how can we find the second part of the tutorial?</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=623#respond' onclick='return addComment.moveForm( "div-comment-623", "623", "respond", "702" )' aria-label='Reply to Saraa'>Reply</a></div></div></div>
</article><ul
class="children"><li
id="comment-626" class="comment byuser comment-author-shanelynn bypostauthor odd alt depth-2">
<article
id="div-comment-626" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">shanelynn</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-626">
<time
class="updated" datetime="2018-01-27T19:12:21+00:00">
January 27, 2018 at 7:12 pm				</time>
</a></div></div><div
class="comment-content"><p>Hi Saraa &#8211; I&#8217;m afraid the second part of the tutorial is delayed due to my time constraints! Its on a todo list &#8211;  Might be short and sweet when I can get it done!</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=626#respond' onclick='return addComment.moveForm( "div-comment-626", "626", "respond", "702" )' aria-label='Reply to shanelynn'>Reply</a></div></div></div>
</article></li></ul></li><li
id="comment-692" class="comment even thread-even depth-1">
<article
id="div-comment-692" class="comment-body media">
<a
class="pull-left" href="#">
</a><div
class="media-body"><div
class="media-body-wrap"><div
class="comment-heading"><h5 class="media-heading"><cite
class="fn">Dhruv</cite></h5><div
class="comment-meta">
<a
href="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/#comment-692">
<time
class="updated" datetime="2018-03-29T04:34:50+00:00">
March 29, 2018 at 4:34 am				</time>
</a></div></div><div
class="comment-content"><p>Wow, amazing tutorial !<br
/>
Thanks for putting this together, really helps.</p></div><div
class="reply comment-reply"><a
rel='nofollow' class='comment-reply-link' href='https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/?replytocom=692#respond' onclick='return addComment.moveForm( "div-comment-692", "692", "respond", "702" )' aria-label='Reply to Dhruv'>Reply</a></div></div></div>
</article></li></ol><div
id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Leave a Reply					<small><a
rel="nofollow" id="cancel-comment-reply-link" href="/merge-join-dataframes-python-pandas-index-1/#respond" style="display:none;">Cancel reply</a></small></h3><form
id="commentform" class="comment-form">
<iframe
title="Comment Form" src="https://jetpack.wordpress.com/jetpack-comment/?blogid=108567932&#038;postid=702&#038;comment_registration=0&#038;require_name_email=1&#038;stc_enabled=1&#038;stb_enabled=1&#038;show_avatars=0&#038;avatar_default=mystery&#038;greeting=Leave+a+Reply&#038;greeting_reply=Leave+a+Reply+to+%25s&#038;color_scheme=light&#038;lang=en_US&#038;jetpack_version=6.0&#038;sig=f65cc652a0f8d11a3baf540383fdd0c701a0de74#parent=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F" style="width:100%; height: 430px; border:0;" name="jetpack_remote_comment" class="jetpack_remote_comment" id="jetpack_remote_comment"></iframe>
<!--[if !IE]><!--> <script>/*<![CDATA[*/document.addEventListener('DOMContentLoaded',function(){var commentForms=document.getElementsByClassName('jetpack_remote_comment');for(var i=0;i<commentForms.length;i++){commentForms[i].allowTransparency=false;commentForms[i].scrolling='no';}});/*]]>*/</script> <!--<![endif]--></form></div>
<input
type="hidden" name="comment_parent" id="comment_parent" value="" /></div></div><div
class="col-sm-12 col-md-3"><div
class="sidebar"><div
class="sidebar-padder"><aside
class="widget shane-widget"><h3 class="widget-title">Coffee money generator:</h3><div
style="margin-left: auto; margin-right: auto; width: 160px; height: 600px; " id="shane-494821140"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins
class="adsbygoogle" style="display:inline-block;width:160px;height:600px;"
data-ad-client="ca-pub-2568178699868194"
data-ad-slot="6223265268"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script> </div><br
style="clear: both; display: block; float: none;"/></aside><aside
id="blog_subscription-2" class="widget jetpack_subscription_widget"><h3 class="widget-title">Subscribe to Blog via Email</h3><form
action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2"><div
id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p></div><p
id="subscribe-email">
<label
id="jetpack-subscribe-label" for="subscribe-field-blog_subscription-2">
Email Address						</label>
<input
type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address" /></p><p
id="subscribe-submit">
<input
type="hidden" name="action" value="subscribe" />
<input
type="hidden" name="source" value="https://www.shanelynn.ie/merge-join-dataframes-python-pandas-index-1/" />
<input
type="hidden" name="sub-type" value="widget" />
<input
type="hidden" name="redirect_fragment" value="blog_subscription-2" />
<input
type="submit" value="Subscribe" name="jetpack_subscriptions_widget" /></p></form> <script>(function(d){if(('placeholder'in d.createElement('input'))){var label=d.querySelector('label[for=subscribe-field-blog_subscription-2]');label.style.clip='rect(1px, 1px, 1px, 1px)';label.style.position='absolute';label.style.height='1px';label.style.width='1px';label.style.overflow='hidden';}
var form=d.getElementById('subscribe-blog-blog_subscription-2'),input=d.getElementById('subscribe-field-blog_subscription-2'),handler=function(event){if(''===input.value){input.focus();if(event.preventDefault){event.preventDefault();}
return false;}};if(window.addEventListener){form.addEventListener('submit',handler,false);}else{form.attachEvent('onsubmit',handler);}})(document);</script> </aside><aside
id="categories-3" class="widget widget_categories"><h3 class="widget-title">Categories</h3><form
action="https://www.shanelynn.ie" method="get"><label
class="screen-reader-text" for="cat">Categories</label><select
name='cat' id='cat' class='postform' ><option
value='-1'>Select Category</option><option
class="level-0" value="14">blog</option><option
class="level-0" value="25">C++</option><option
class="level-0" value="105">Cycling</option><option
class="level-0" value="16">data science</option><option
class="level-0" value="103">Data Visualisation</option><option
class="level-0" value="167">Natural Language Processing</option><option
class="level-0" value="112">Pandas</option><option
class="level-0" value="27">python</option><option
class="level-0" value="9">R</option><option
class="level-0" value="26">ROS</option><option
class="level-0" value="24">Software</option><option
class="level-0" value="113">Tutorials</option><option
class="level-0" value="1">Uncategorized</option><option
class="level-0" value="43">web</option>
</select></form> <script type='text/javascript'>(function(){var dropdown=document.getElementById("cat");function onCatChange(){if(dropdown.options[dropdown.selectedIndex].value>0){dropdown.parentNode.submit();}}
dropdown.onchange=onCatChange;})();</script> </aside><aside
id="custom-twitter-feeds-widget-2" class="widget widget_custom-twitter-feeds-widget"><div
id="ctf" class="ctf ctf-type-usertimeline  ctf-styles" style="width: 100%;" data-ctfshortcode="{}" data-ctfneeded="0"><div
class="ctf-header ctf-no-bio" style=""><a
href="https://twitter.com/shane_a_lynn" target="_blank" title="@shane_a_lynn" class="ctf-header-link"><div
class="ctf-header-text"><p
class="ctf-header-user" style=""><span
class="ctf-header-name">Shane Lynn</span><span
class="ctf-header-follow"><i
class="fa fa-twitter" aria-hidden="true"></i>Follow</span></p></div><div
class="ctf-header-img"><div
class="ctf-header-img-hover"><i
class="fa fa-twitter" aria-hidden="true"></i></div><img
src="https://pbs.twimg.com/profile_images/413684983929135105/aJtBkzZK_normal.png" alt="Shane Lynn" width="48" height="48"></div></a></div><div
class="ctf-tweets"><div
class="ctf-item ctf-author-shane_a_lynn ctf-new" id="994632544158212096" style=""><div
class="ctf-author-box"><div
class="ctf-author-box-link" target="_blank" style=""><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-avatar" target="_blank" style=""><img
src="https://pbs.twimg.com/profile_images/413684983929135105/aJtBkzZK_normal.png" alt="shane_a_lynn" width="48" height="48"></a><a
href="https://twitter.com/shane_a_lynn" target="_blank" class="ctf-author-name" style="">Shane Lynn</a><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-screenname" target="_blank" style="">@shane_a_lynn</a><span
class="ctf-screename-sep">&middot;</span><div
class="ctf-tweet-meta"><a
href="https://twitter.com/shane_a_lynn/status/994632544158212096" class="ctf-tweet-date" target="_blank" style="">10 May</a></div></div></div><div
class="ctf-tweet-content"><p
class="ctf-tweet-text" style="">There was a new bulletin yesterday, on national news in @ireland, about how these 22 WILD and WANDERING GOATS were "terrorising" Ennis, a western town. What an incredibly Irish story. @rtenews  #ahcmon #goatterrorists</p><a
href="https://twitter.com/shane_a_lynn/status/994632544158212096" target="_blank" class="ctf-tweet-text-media-wrap"><i
style="padding-right: 5px;" class="fa fa-picture-o ctf-tweet-text-media" aria-hidden="true"></i></a></div><div
class="ctf-tweet-actions"><a
href="https://twitter.com/intent/tweet?in_reply_to=994632544158212096&related=shane_a_lynn" class="ctf-reply" target="_blank" style=""><i
class="fa fa-reply" aria-hidden="true"></i><span
class="ctf-screenreader">Reply on Twitter</span></a><a
href="https://twitter.com/intent/retweet?tweet_id=994632544158212096&related=shane_a_lynn" class="ctf-retweet" target="_blank" style=""><i
class="fa fa-retweet" aria-hidden="true"></i><span
class="ctf-screenreader">Retweet on Twitter</span><span
class="ctf-action-count ctf-retweet-count"></span></a><a
href="https://twitter.com/intent/like?tweet_id=994632544158212096&related=shane_a_lynn" class="ctf-like" target="_blank" style=""><i
class="fa fa-heart" aria-hidden="true"></i><span
class="ctf-screenreader">Like on Twitter</span><span
class="ctf-action-count ctf-favorite-count">3</span></a><a
href="https://twitter.com/shane_a_lynn/status/994632544158212096" class="ctf-twitterlink" style="" target="_blank">Twitter</a></div></div><div
class="ctf-item ctf-author-shane_a_lynn ctf-new ctf-quoted" id="994631717297315841" style=""><div
class="ctf-author-box"><div
class="ctf-author-box-link" target="_blank" style=""><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-avatar" target="_blank" style=""><img
src="https://pbs.twimg.com/profile_images/413684983929135105/aJtBkzZK_normal.png" alt="shane_a_lynn" width="48" height="48"></a><a
href="https://twitter.com/shane_a_lynn" target="_blank" class="ctf-author-name" style="">Shane Lynn</a><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-screenname" target="_blank" style="">@shane_a_lynn</a><span
class="ctf-screename-sep">&middot;</span><div
class="ctf-tweet-meta"><a
href="https://twitter.com/shane_a_lynn/status/994631717297315841" class="ctf-tweet-date" target="_blank" style="">10 May</a></div></div></div><div
class="ctf-tweet-content"><p
class="ctf-tweet-text" style="">Ireland finally starting to see sense?</div><div
class="ctf-tweet-actions"><a
href="https://twitter.com/intent/tweet?in_reply_to=994631717297315841&related=shane_a_lynn" class="ctf-reply" target="_blank" style=""><i
class="fa fa-reply" aria-hidden="true"></i><span
class="ctf-screenreader">Reply on Twitter</span></a><a
href="https://twitter.com/intent/retweet?tweet_id=994631717297315841&related=shane_a_lynn" class="ctf-retweet" target="_blank" style=""><i
class="fa fa-retweet" aria-hidden="true"></i><span
class="ctf-screenreader">Retweet on Twitter</span><span
class="ctf-action-count ctf-retweet-count"></span></a><a
href="https://twitter.com/intent/like?tweet_id=994631717297315841&related=shane_a_lynn" class="ctf-like" target="_blank" style=""><i
class="fa fa-heart" aria-hidden="true"></i><span
class="ctf-screenreader">Like on Twitter</span><span
class="ctf-action-count ctf-favorite-count">1</span></a><a
href="https://twitter.com/shane_a_lynn/status/994631717297315841" class="ctf-twitterlink" style="" target="_blank">Twitter</a></div></div><div
class="ctf-item ctf-author-shane_a_lynn ctf-new" id="993954883446411264" style=""><div
class="ctf-author-box"><div
class="ctf-author-box-link" target="_blank" style=""><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-avatar" target="_blank" style=""><img
src="https://pbs.twimg.com/profile_images/413684983929135105/aJtBkzZK_normal.png" alt="shane_a_lynn" width="48" height="48"></a><a
href="https://twitter.com/shane_a_lynn" target="_blank" class="ctf-author-name" style="">Shane Lynn</a><a
href="https://twitter.com/shane_a_lynn" class="ctf-author-screenname" target="_blank" style="">@shane_a_lynn</a><span
class="ctf-screename-sep">&middot;</span><div
class="ctf-tweet-meta"><a
href="https://twitter.com/shane_a_lynn/status/993954883446411264" class="ctf-tweet-date" target="_blank" style="">8 May</a></div></div></div><div
class="ctf-tweet-content"><p
class="ctf-tweet-text" style="">Google Duplex has been in the work for many years - next-level #conversationalAI from @Google at #GoogleIO https://t.co/izHiRr3xGH #googleduplex</p><a
href="https://twitter.com/shane_a_lynn/status/993954883446411264" target="_blank" class="ctf-tweet-text-media-wrap"><i
style="padding-right: 5px;" class="fa fa-picture-o ctf-tweet-text-media" aria-hidden="true"></i></a></div><div
class="ctf-tweet-actions"><a
href="https://twitter.com/intent/tweet?in_reply_to=993954883446411264&related=shane_a_lynn" class="ctf-reply" target="_blank" style=""><i
class="fa fa-reply" aria-hidden="true"></i><span
class="ctf-screenreader">Reply on Twitter</span></a><a
href="https://twitter.com/intent/retweet?tweet_id=993954883446411264&related=shane_a_lynn" class="ctf-retweet" target="_blank" style=""><i
class="fa fa-retweet" aria-hidden="true"></i><span
class="ctf-screenreader">Retweet on Twitter</span><span
class="ctf-action-count ctf-retweet-count"></span></a><a
href="https://twitter.com/intent/like?tweet_id=993954883446411264&related=shane_a_lynn" class="ctf-like" target="_blank" style=""><i
class="fa fa-heart" aria-hidden="true"></i><span
class="ctf-screenreader">Like on Twitter</span><span
class="ctf-action-count ctf-favorite-count">1</span></a><a
href="https://twitter.com/shane_a_lynn/status/993954883446411264" class="ctf-twitterlink" style="" target="_blank">Twitter</a></div></div><div
class="ctf-item ctf-author-shane_a_lynn ctf-new ctf-retweet" id="993946670684672001" style=""><div
class="ctf-context"><a
href="https://twitter.com/intent/user?screen_name=shane_a_lynn" target="_blank" class="ctf-retweet-icon"><i
class="fa fa-retweet" aria-hidden="true"></i><span
class="ctf-screenreader">Retweet on Twitter</span></a><a
href="https://twitter.com/shane_a_lynn" target="_blank" class="ctf-retweet-text" style="">Shane Lynn Retweeted</a></div><div
class="ctf-author-box"><div
class="ctf-author-box-link" target="_blank" style=""><a
href="https://twitter.com/parsaghaffari" class="ctf-author-avatar" target="_blank" style=""><img
src="https://pbs.twimg.com/profile_images/858222398218399745/jzNUGlMy_normal.jpg" alt="parsaghaffari" width="48" height="48"></a><a
href="https://twitter.com/parsaghaffari" target="_blank" class="ctf-author-name" style="">Parsa Ghaffari</a><a
href="https://twitter.com/parsaghaffari" class="ctf-author-screenname" target="_blank" style="">@parsaghaffari</a><span
class="ctf-screename-sep">&middot;</span><div
class="ctf-tweet-meta"><a
href="https://twitter.com/parsaghaffari/status/993939247152422912" class="ctf-tweet-date" target="_blank" style="">8 May</a></div></div></div><div
class="ctf-tweet-content"><p
class="ctf-tweet-text" style="">Google Duplex is pretty cool. The "opening hours" example (where the AI calls a restaurant and asks their holiday opening hours) hints at a new and very important era in crawling information: crawling non-digitized human knowledge. https://t.co/exozknzLiu</div><div
class="ctf-tweet-actions"><a
href="https://twitter.com/intent/tweet?in_reply_to=993939247152422912&related=parsaghaffari" class="ctf-reply" target="_blank" style=""><i
class="fa fa-reply" aria-hidden="true"></i><span
class="ctf-screenreader">Reply on Twitter</span></a><a
href="https://twitter.com/intent/retweet?tweet_id=993939247152422912&related=parsaghaffari" class="ctf-retweet" target="_blank" style=""><i
class="fa fa-retweet" aria-hidden="true"></i><span
class="ctf-screenreader">Retweet on Twitter</span><span
class="ctf-action-count ctf-retweet-count">11</span></a><a
href="https://twitter.com/intent/like?tweet_id=993939247152422912&related=parsaghaffari" class="ctf-like" target="_blank" style=""><i
class="fa fa-heart" aria-hidden="true"></i><span
class="ctf-screenreader">Like on Twitter</span><span
class="ctf-action-count ctf-favorite-count">19</span></a><a
href="https://twitter.com/parsaghaffari/status/993939247152422912" class="ctf-twitterlink" style="" target="_blank">Twitter</a></div></div></div><a
href="javascript:void(0);" id="ctf-more" class="ctf-more" style=""><span>Load More...</span></a></div></aside></div></div></div></div></div></div></div><footer
id="colophon" class="site-footer" role="contentinfo"><div
class="container animated fadeInLeft"><div
class="row"><div
class="site-footer-inner col-sm-12 clearfix"><div
class="sidebar-padder"><aside
id="categories-2" class="widget widget_categories col-3"><h3 class="widget-title">Categories</h3><ul><li
class="cat-item cat-item-14"><a
href="https://www.shanelynn.ie/category/blog/" >blog</a></li><li
class="cat-item cat-item-25"><a
href="https://www.shanelynn.ie/category/c/" >C++</a></li><li
class="cat-item cat-item-105"><a
href="https://www.shanelynn.ie/category/cycling/" >Cycling</a></li><li
class="cat-item cat-item-16"><a
href="https://www.shanelynn.ie/category/blog/data-science/" >data science</a></li><li
class="cat-item cat-item-103"><a
href="https://www.shanelynn.ie/category/blog/data-visualisation/" >Data Visualisation</a></li><li
class="cat-item cat-item-167"><a
href="https://www.shanelynn.ie/category/blog/natural-language-processing/" >Natural Language Processing</a></li><li
class="cat-item cat-item-112"><a
href="https://www.shanelynn.ie/category/pandas/" >Pandas</a></li><li
class="cat-item cat-item-27"><a
href="https://www.shanelynn.ie/category/blog/python/" >python</a></li><li
class="cat-item cat-item-9"><a
href="https://www.shanelynn.ie/category/blog/r/" >R</a></li><li
class="cat-item cat-item-26"><a
href="https://www.shanelynn.ie/category/ros/" >ROS</a></li><li
class="cat-item cat-item-24"><a
href="https://www.shanelynn.ie/category/software/" >Software</a></li><li
class="cat-item cat-item-113"><a
href="https://www.shanelynn.ie/category/tutorials/" >Tutorials</a></li><li
class="cat-item cat-item-1"><a
href="https://www.shanelynn.ie/category/uncategorized/" >Uncategorized</a></li><li
class="cat-item cat-item-43"><a
href="https://www.shanelynn.ie/category/blog/web/" >web</a></li></ul>
</aside><aside
id="linkcat-8" class="widget widget_links col-3"><h3 class="widget-title">Footer links</h3><ul
class='xoxo blogroll'><li><a
href="http://www.meetup.com/DublinR/" title="Meetup page for the Dublin R Users group who regularly host talks on different aspects of using R" target="_blank">Dublin R Users Group</a></li><li><a
href="http://www.r-bloggers.com/" title="Great collection of R related blog content from around the web." target="_blank">R-bloggers</a></li><li><a
href="http://www.rstudio.com" title="Fantastic editor and IDE for R programming" target="_blank">RStudio</a></li><li><a
href="http://www.udacity.com" title="Udacity &#8211; Online Learning University" target="_blank">Udacity</a></li><li><a
href="https://www.shanelynn.ie/useful-resources" title="Useful resources from around the internet.">Useful Resources</a></li></ul>
</aside>
<aside
id="search-2" class="widget widget_search col-3"><h3 class="widget-title">Search</h3><form
role="search" method="get" class="search-form" action="https://www.shanelynn.ie/">
<label>
<input
type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:">
</label>
<input
type="submit" class="search-submit" value="Search"></form>
</aside><aside
id="pages-3" class="widget widget_pages col-3"><h3 class="widget-title">Pages</h3><ul><li
class="page_item page-item-2"><a
href="https://www.shanelynn.ie/about/">About</a></li><li
class="page_item page-item-680"><a
href="https://www.shanelynn.ie/consultancy-services/">Consultancy &#038; Services</a></li><li
class="page_item page-item-27"><a
href="https://www.shanelynn.ie/contact/">Contact</a></li><li
class="page_item page-item-67"><a
href="https://www.shanelynn.ie/publications/">Publications</a></li><li
class="page_item page-item-25"><a
href="https://www.shanelynn.ie/research/">Research</a></li><li
class="page_item page-item-802"><a
href="https://www.shanelynn.ie/useful-resources/">Useful Resources</a></li></ul>
</aside></div></div></div></div><div
id="footer-info"><div
class="container"><div
class="site-info">
<a
href="http://wordpress.org/" title="A Semantic Personal Publishing Platform" >&copy; 2016 ascent. All rights reserved</a>
<span
class="sep"> | </span>
Ascent by   <a
href="http://nettantra.com/" target="_blank">NetTantra</a></div></div></div>
</footer> <script>/*<![CDATA[*/var advanced_ads_ga_UID='';advanced_ads_check_adblocker=function(t){function e(t){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,16)}).call(window,t)}var n=[],a=null;return e(function(){var t=document.createElement("div");t.innerHTML="&nbsp;",t.setAttribute("class","ad_unit ad-unit text-ad text_ad pub_300x250"),t.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;"),document.body.appendChild(t),e(function(){var e=window.getComputedStyle&&window.getComputedStyle(t),o=e&&e.getPropertyValue("-moz-binding");a=e&&"none"===e.getPropertyValue("display")||"string"==typeof o&&-1!==o.indexOf("about:");for(var i=0;i<n.length;i++)n[i](a);n=[]})}),function(t){if(null===a)return void n.push(t);t(a)}}(),function(){var t=function(t,e){this.name=t,this.UID=e,this.analyticsObject=null;var n=this,a={hitType:"event",eventCategory:"Advanced Ads",eventAction:"AdBlock",eventLabel:"Yes",nonInteraction:!0,transport:"beacon"};this.analyticsObject="string"==typeof GoogleAnalyticsObject&&"function"==typeof window[GoogleAnalyticsObject]&&window[GoogleAnalyticsObject],!1===this.analyticsObject?(!function(t,e,n,a,o,i,d){t.GoogleAnalyticsObject=o,t[o]=t[o]||function(){(t[o].q=t[o].q||[]).push(arguments)},t[o].l=1*new Date,i=e.createElement(n),d=e.getElementsByTagName(n)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",d.parentNode.insertBefore(i,d)}(window,document,"script",0,"_advads_ga"),_advads_ga("create",n.UID,"auto",this.name),_advads_ga(n.name+".send",a)):(window.console&&window.console.log("Advanced Ads Analytics >> using other's variable named `"+GoogleAnalyticsObject+"`"),window[GoogleAnalyticsObject]("create",n.UID,"auto",this.name),window[GoogleAnalyticsObject](n.name+".send",a))};advanced_ads_check_adblocker(function(e){e&&"string"==typeof advanced_ads_ga_UID&&advanced_ads_ga_UID&&new t("advadsTracker",advanced_ads_ga_UID)})}();/*]]>*/</script><div
id="hbcxdFCLQLTp" class="AnEaCyNbUfNi" style="background:#dddddd;z-index:9999999; "></div> <script type="text/javascript">/*<![CDATA[*/var anOptions={"anOptionChoice":"2","anOptionStats":"1","anOptionAdsSelectors":"","anOptionCookie":"1","anOptionCookieLife":"30","anPageRedirect":"","anPermalink":"undefined","anOptionModalEffect":"none","anOptionModalspeed":"350","anOptionModalclose":false,"anOptionModalOverlay":"rgba( 0,0,0,0.8 )","anAlternativeActivation":false,"anAlternativeElement":"","anAlternativeText":"<p><strong>AdBlock detected!<\/strong><\/p>\n<p>Please add <a title=\"https:\/\/getadmiral.com?utm_medium=plugin&utm_campaign=abn&utm_source=abnlinks\" href=\"themeisle.com\" target=\"_blank\">www.getadmiral.com<\/a> to your adblocking whitelist or disable your adblocking software.<\/p>\n","anAlternativeClone":"2","anAlternativeProperties":"","anOptionModalShowAfter":0,"anPageMD5":"","anSiteID":0,"modalHTML":"<div class=\"AnEaCyNbUfNi-default\">\n\t<h1 style=\"\">I use ads to pay for hosting and coffee<\/h1>\n\t<p>There's a few ads on this site. It makes about $30 a month (which I think is great) and that pays for hosting at Digital Ocean and some coffee.<\/p>\n<p>I've\u00a0detected that you are using AdBlock Plus or some other adblocking software which is preventing the page from fully loading.<\/p>\n<p><strong>Please add <a title=\"Shane Lynn\" href=\"http:\/\/www.shanelynn.ie\" target=\"_blank\" rel=\"noopener\">www.shanelynn.ie<\/a> to your ad blocking whitelist or disable your adblocking software when you're on this site.<\/strong><\/p>\n<\/div>\n<a class=\"close-modal close-AnEaCyNbUfNi\">&#215;<\/a>"}/*]]>*/</script><div
id="adsense" class="an-sponsored" style="position:absolute; z-index:-1; height:1px; width:1px; visibility: hidden; top: -1px; left: 0;"><img
class="an-advert-banner" alt="sponsored" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-44822631-1','auto');ga('send','pageview');</script><!--[if lte IE 8]><link
rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel-ie8fix.css?ver=20121024' type='text/css' media='all' />
<![endif]--><link
rel='stylesheet' id='crayon-css'  href='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' /> <script type='text/javascript'>var wpcf7={"apiSettings":{"root":"https:\/\/www.shanelynn.ie\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.1'></script> <script type='text/javascript'>var ctf={"ajax_url":"https:\/\/www.shanelynn.ie\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/custom-twitter-feeds/js/ctf-scripts.js?ver=1.2.8'></script> <script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201819'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/themes/ascent/includes/js/skip-link-focus-fix.js?ver=20130115'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.5'></script> <script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools.min.js'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/enlighter/resources/EnlighterJS.min.js?ver=3.5'></script> <script type='text/javascript'>var ajax_object={"nonce":"2a61f6d60a","ajaxurl":"https:\/\/www.shanelynn.ie\/wp-admin\/admin-ajax.php"};</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/uploads/ywrMnyIoxdTt/oIWjOKsshQuI.js?ver=2.2.3'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.5'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/spin.min.js?ver=1.3'></script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/jquery.spin.min.js?ver=1.3'></script> <script type='text/javascript'>/*<![CDATA[*/var jetpackCarouselStrings={"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/www.shanelynn.ie\/wp-admin\/admin-ajax.php","nonce":"4402242803","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/www.shanelynn.ie\/wp-login.php?redirect_to=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};/*]]>*/</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=20170209'></script> <script type='text/javascript'>var CrayonSyntaxSettings={"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.shanelynn.ie\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};var CrayonSyntaxStrings={"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};</script> <script type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script> <script async="async" type='text/javascript' src='https://shanelynnwebsite-mid9n9g1q9y8tt.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.0.3'></script> <script type="text/javascript">/*<![CDATA[*/EnlighterJS_Config={"selector":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"language":"python","theme":"enlighter","indent":2,"hover":"hoverEnabled","showLinenumbers":true,"rawButton":true,"infoButton":true,"windowButton":true,"rawcodeDoubleclick":false,"grouping":true,"cryptex":{"enabled":false,"email":"mail@example.tld"}};!function(){var a=function(a){var b="Enlighter Error: ";console.error?console.error(b+a):console.log&&console.log(b+a)};return window.addEvent?"undefined"==typeof EnlighterJS?void a("Javascript Resources not loaded yet!"):"undefined"==typeof EnlighterJS_Config?void a("Configuration not loaded yet!"):void window.addEvent("domready",function(){EnlighterJS.Util.Init(EnlighterJS_Config.selector.block,EnlighterJS_Config.selector.inline,EnlighterJS_Config)}):void a("MooTools Framework not loaded yet!")}();;/*]]>*/</script> <!--[if IE]> <script type="text/javascript">if(0===window.location.hash.indexOf('#comment-')){window.location.hash=window.location.hash;}</script> <![endif]--> <script type="text/javascript">/*<![CDATA[*/(function(){var comm_par_el=document.getElementById('comment_parent'),comm_par=(comm_par_el&&comm_par_el.value)?comm_par_el.value:'',frame=document.getElementById('jetpack_remote_comment'),tellFrameNewParent;tellFrameNewParent=function(){if(comm_par){frame.src="https://jetpack.wordpress.com/jetpack-comment/?blogid=108567932&postid=702&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=0&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=6.0&sig=f65cc652a0f8d11a3baf540383fdd0c701a0de74#parent=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F"+'&replytocom='+parseInt(comm_par,10).toString();}else{frame.src="https://jetpack.wordpress.com/jetpack-comment/?blogid=108567932&postid=702&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=0&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=6.0&sig=f65cc652a0f8d11a3baf540383fdd0c701a0de74#parent=https%3A%2F%2Fwww.shanelynn.ie%2Fmerge-join-dataframes-python-pandas-index-1%2F";}};if('undefined'!==typeof addComment){addComment._Jetpack_moveForm=addComment.moveForm;addComment.moveForm=function(commId,parentId,respondId,postId){var returnValue=addComment._Jetpack_moveForm(commId,parentId,respondId,postId),cancelClick,cancel;if(false===returnValue){cancel=document.getElementById('cancel-comment-reply-link');cancelClick=cancel.onclick;cancel.onclick=function(){var cancelReturn=cancelClick.call(this);if(false!==cancelReturn){return cancelReturn;}
if(!comm_par){return cancelReturn;}
comm_par=0;tellFrameNewParent();return cancelReturn;};}
if(comm_par==parentId){return returnValue;}
comm_par=parentId;tellFrameNewParent();return returnValue;};}
document.addEventListener('DOMContentLoaded',function(){var iframe_url="https:\/\/jetpack.wordpress.com";if(window.postMessage){if(document.addEventListener){window.addEventListener('message',function(event){var origin=event.origin.replace(/^http:\/\//i,'https://');if(iframe_url.replace(/^http:\/\//i,'https://')!==origin){return;}
jQuery(frame).height(event.data);});}else if(document.attachEvent){window.attachEvent('message',function(event){var origin=event.origin.replace(/^http:\/\//i,'https://');if(iframe_url.replace(/^http:\/\//i,'https://')!==origin){return;}
jQuery(frame).height(event.data);});}}})})();/*]]>*/</script> <script type='text/javascript' src='https://stats.wp.com/e-201819.js' async='async' defer='defer'></script> <script type='text/javascript'>_stq=window._stq||[];_stq.push(['view',{v:'ext',j:'1:6.0',blog:'108567932',post:'702',tz:'0',srv:'www.shanelynn.ie'}]);_stq.push(['clickTrackerInit','108567932','702']);</script> </body></html>